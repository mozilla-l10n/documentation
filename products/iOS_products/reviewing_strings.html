<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Reviewing new strings - Localization at Mozilla - Internal Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Localization at Mozilla - Internal Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/mozilla-l10n/documentation/" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/mozilla-l10n/documentation/edit/main/src/products/iOS_products/reviewing_strings.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="reviewing-strings-for-a-new-release-of-mozilla-ios-products"><a class="header" href="#reviewing-strings-for-a-new-release-of-mozilla-ios-products">Reviewing strings for a new release of Mozilla iOS products</a></h1>
<p>Usually, a new release of our iOS products means an update to strings. Like for Android products, mobile developers will land strings in their respective code repositories throughout the <a href="https://whattrainisitnow.com/">release cycle</a>, and automation will export these strings to the localization repository, where they will need to be reviewed by a localization EPM before being exposed to localizers on Pontoon (see <a href="adding_projects.html">Adding projects</a> for more details on the automation used).</p>
<p>It's also possible to manually trigger a string import (<code>import_strings.yml</code>) at any time. To do so, go to the GitHub <code>Actions</code> section of the relevant localization iOS repository and run the string import workflow.  Manual string imports are useful in cases when developers land new, time-sensitive strings (like for an upcoming release), when updates or fixes in the code need to be pulled in before the next scheduled import, or in cases where you’d like to use a different criterion (described below).</p>
<p>Here are more details on how the automation works (<a href="https://github.com/mozilla-l10n/firefoxios-l10n/tree/main/en-US">example</a> with Firefox for iOS):</p>
<ol>
<li>Strings are extracted and saved in an <code>en-US</code> XLIFF file.</li>
<li>The updated <code>en-US</code> XLIFF is used as a template. For each locale, existing translations are copied over if all these elements match:
<ul>
<li><code>id</code> attribute of <code>trans-unit</code>.</li>
<li><code>original</code> attribute of <code>file</code>.</li>
<li><code>source</code> text.</li>
</ul>
</li>
</ol>
<p>As a consequence, the default update removes translations if:</p>
<ul>
<li>The source text was changed.</li>
<li>The string was moved from one file to another.</li>
</ul>
<p>This is not ideal when the change in the source text is trivial, or the string move is caused by code refactoring. For this reason it’s also possible to invoke <a href="https://github.com/mozilla-l10n/firefoxios-l10n/actions/workflows/import_strings.yml">automation manually</a> and use a different matching criterion:</p>
<ul>
<li><code>nofile</code> will copy translations if the ID and source text match, ignoring the file. This is useful to minimize the impact of code refactoring.</li>
<li><code>matchid</code> will ignore both file and source text, copying translations if the ID matches. This is useful for source changes that don’t require invalidating existing translations.</li>
</ul>
<p>Once new strings have landed from the source repository, or you have manually triggered an import, the PR is reviewed by a localization staff — most often by the EPM in charge of mobile projects.</p>
<p>Note that there is a linter in place that checks reference strings for common errors. When opening a pull request that touches the <code>en-US</code> folder, a GitHub workflow is used to identify errors such as misused quotes or ellipsis, and hard-coded brand names. It's possible to add exceptions in the corresponding JSON file (for example <a href="https://github.com/mozilla-l10n/firefoxios-l10n/blob/main/.github/scripts/linter_config.json">here</a> for Firefox). The linter is also running in the <a href="https://github.com/mozilla-mobile/firefox-ios/blob/main/.github/workflows/firefox-ios-l10n-linter.yml">code repository</a>, for both Firefox and Focus, with their own <a href="https://github.com/mozilla-mobile/firefox-ios/tree/main/.github/l10n">exceptions</a>.</p>
<p>Let’s go over some of the steps needed over time in order to review correctly strings for a new release.</p>
<h2 id="reviewing-the-pr"><a class="header" href="#reviewing-the-pr">Reviewing the PR</a></h2>
<p>Let's consider Firefox for iOS as an example. As a matter of fact, the iOS release cycles follow closely the Android and Firefox desktop calendar, which can be found <a href="https://whattrainisitnow.com">here</a>. During the release cycle, automation will create pull requests as explained in the section above, in order to land strings for the upcoming release.</p>
<p>In general, you should try to review the strings landing, and try to localize them in your head: how would you translate them? Would you be able to do it without the app? Is the localization comment clear enough? Let’s consider a past PR, <a href="https://github.com/mozilla-l10n/firefoxios-l10n/pull/192">here</a>.</p>
<p>The first thing you’ll want to do is to examine the changes to the <a href="https://github.com/mozilla-l10n/firefoxios-l10n/pull/192/files#diff-6f29eb799be1b575316c0187d69a38fce3c63e27e5a22eb180b338ee177e9cae">source string folder</a> (called <code>templates</code>).</p>
<h3 id="acceptable-changes"><a class="header" href="#acceptable-changes">Acceptable changes</a></h3>
<p>Changes to attributes like <code>tool-version</code> and <code>build-num</code> are expected, they happen every time the version of Xcode changes in automation. Seeing <code>datatype="plaintext"</code> move to the end of <code>file original</code> is also acceptable, such as <a href="https://github.com/mozilla-l10n/firefoxios-l10n/pull/195/files#diff-6f29eb799be1b575316c0187d69a38fce3c63e27e5a22eb180b338ee177e9caeL3529">here</a>.</p>
<p>Note that these will not appear as new strings for localizers and they will not need to retranslate them.</p>
<p>Changes to comments (<code>&lt;note&gt;</code>) are irrelevant in terms of string updates, so they’re also OK.</p>
<h3 id="potentially-problematic-changes"><a class="header" href="#potentially-problematic-changes">Potentially problematic changes</a></h3>
<p>Then you start scrolling down, confirming if the new strings are clear: the first one you find is <code>CreditCard.DisplayCard.ExpiresLabel.v115</code>.</p>
<p>Things to look out for:</p>
<ul>
<li>Unclear strings and missing localization comments: the best way to identify them is to translate the strings, only having the string and comment as context (not the entire file, or the associated commit where the string landed). For example: is the word used both a noun and a verb in English? Is the ID clear enough to give context (e.g. <code>buttonLabel</code>)?</li>
<li>String changes without new IDs. IDs in XLIFF files are stored in the <code>trans-unit</code> attribute; for example, the ID of <a href="https://github.com/mozilla-l10n/firefoxios-l10n/pull/192/files#diff-6f29eb799be1b575316c0187d69a38fce3c63e27e5a22eb180b338ee177e9caeR3201">this string</a> is <code>CreditCard.DisplayCard.ExpiresLabel.v115</code>.</li>
<li>Other general <a href="https://mozilla-l10n.github.io/documentation/localization/dev_best_practices.html">localization issues</a>.</li>
</ul>
<h3 id="quickly-review-other-locales"><a class="header" href="#quickly-review-other-locales">Quickly review other locales</a></h3>
<p>Once you’ve checked <code>templates</code>, you can pick at least one other locale and see what changes, as you can see <a href="https://github.com/mozilla-l10n/firefoxios-l10n/pull/192/files#diff-220a1dc4ddc01bbae6a176ba4122aa644042181c78a638b052f45462b758ca6f">for example here</a>. Checking another locale helps to easily spot if there are any file removals that might be deleting entire sections of existing translations.</p>
<p>Any time you are unsure about deletions, pinging an iOS developer is recommended.</p>
<h3 id="how-to-find-the-commit-introducing-a-change"><a class="header" href="#how-to-find-the-commit-introducing-a-change">How to find the commit introducing a change</a></h3>
<p>You may also need to identify the commit that introduced a string in order to contact the developer who added it, so they can make the necessary fix. The following section explains how to find that commit.</p>
<p>Let’s consider an example of new strings for Firefox for iOS, with <a href="https://github.com/mozilla-l10n/firefoxios-l10n/pull/192">this past PR</a>.</p>
<p>The ID is <code>CreditCard.DisplayCard.ExpiresLabel.v115</code>, the label <code>Expires</code>. Imagine there is no localization comment there, you will want to know which GitHub PR introduced this string, and who was the author.</p>
<p>Currently, the only strings that can not have localization comments are strings that are located in <code>InfoPlist.strings</code> and <code>Info.plist</code> - see <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1277515">Bug 1277515</a> for more details. Otherwise, strings should always have localization comments.</p>
<p>First open the <a href="https://github.com/mozilla-mobile/firefox-ios">code repository page</a>. Then use the search box at the top, searching for the <a href="https://github.com/search?q=repo%3Amozilla-mobile%2Ffirefox-ios%20CreditCard.DisplayCard.ExpiresLabel.v115&amp;type=code">string ID (or the string)</a>. To the left, filter by <code>Pull Requests</code>. This should bring you to the Pull Request where the string was introduced, as well as the author of the string.</p>
<p>If there are no PRs associated with the string, instead click on the search results appearing to the right of the "Filter by" selector. Choose the file ending with <code>/Strings.swift</code>, to open up (in this case) <a href="https://github.com/mozilla-mobile/firefox-ios/blob/4bba2a088f0e5795dca89c10b3194dd97f3c2621/Client/Frontend/Strings.swift#L250">this file</a>. Then use the <code>Blame</code> <a href="https://github.com/mozilla-mobile/firefox-ios/blame/4bba2a088f0e5795dca89c10b3194dd97f3c2621/Client/Frontend/Strings.swift#L250">link</a> on the top left. Then on the left, you will see the GitHub PR that introduced the string and its author.</p>
<p>If the search doesn't return the expected string (which is common), you can manually locate it in the <code>/Strings.swift</code> file (<a href="https://github.com/mozilla-mobile/firefox-ios/blob/main/firefox-ios/Shared/Strings.swift">example</a> with Firefox for iOS), and click <code>Blame</code> on the top left.</p>
<p>You can then CC directly the author of the string in the new strings PR that arrived in the <code>mozilla-l10n</code> repository, and ask for a fix there.</p>
<h2 id="wrapping-up-your-work"><a class="header" href="#wrapping-up-your-work">Wrapping up your work</a></h2>
<p>So you’ve reviewed the strings, and the PR looks good — this means you can now merge the PR so the strings get exposed in Pontoon.</p>
<p>The Pontoon project (<a href="https://pontoon.mozilla.org/projects/firefox-for-ios/">here for Firefox for iOS</a> and <a href="https://pontoon.mozilla.org/projects/focus-for-ios/">here for Focus for iOS</a>) should get the new strings automatically after a few minutes, but it’s always a good idea to double-check just in case. You can also manually <a href="https://pontoon.mozilla.org/sync/">force sync</a> the project.</p>
<p>One last thing is to not forget to update the localization completion deadline under Pontoon resources for each product.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../products/iOS_products/updating_locales.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../products/iOS_products/screenshots.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../products/iOS_products/updating_locales.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../products/iOS_products/screenshots.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
