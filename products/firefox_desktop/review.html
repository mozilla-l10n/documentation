<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Review strings - Localization at Mozilla - Internal Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Localization at Mozilla - Internal Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/mozilla-l10n/documentation/" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/mozilla-l10n/documentation/edit/main/src/products/firefox_desktop/review.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="reviewing-strings-in-firefox-desktop"><a class="header" href="#reviewing-strings-in-firefox-desktop">Reviewing strings in Firefox desktop</a></h1>
<ul>
<li><a href="#review-landed-strings">Review landed strings</a>
<ul>
<li><a href="#review-strings-landing-in-repository-using-legacy-mozilla-central">Review strings landing in repository (using legacy mozilla-central)</a></li>
<li><a href="#review-strings-in-update-branch-of-firefox-l10n-source">Review strings in update branch of firefox-l10n-source</a></li>
<li><a href="#run-compare-locales-against-a-localization-repository">Run compare-locales against a localization repository</a></li>
<li><a href="#merge-reviewed-strings-to-main-branch-of-firefox-l10n-source">Merge reviewed strings to main branch of firefox-l10n-source</a></li>
</ul>
</li>
</ul>
<h2 id="review-landed-strings"><a class="header" href="#review-landed-strings">Review landed strings</a></h2>
<p>All versions of Firefox desktop ship by localizing a single repository containing the reference English strings, called <a href="https://github.com/mozilla-l10n/firefox-l10n-source">firefox-l10n-source</a>. It is generated from strings landing in the Firefox source code repository <a href="https://github.com/mozilla-firefox/firefox">mozilla-firefox</a>. Automation in <code>firefox-l10n-source</code> extracts strings from each of the version specific branches in <code>mozilla-firefox</code> (e.g. main for Nightly, beta for Beta, release for Release, etc.).</p>
<p>There are two branches in <code>firefox-l10n-source</code>: <code>main</code> which contains all strings currently exposed for localization, and <code>update</code> which acts as a string quarantine, used as a buffer to avoid exposing poor strings to the larger audience of localizers. Strings are regularly merged from <code>update</code> into <code>main</code> after a review by the Localization Team; newly added and removed strings in <code>main</code> are synced with our localization tool Pontoon.</p>
<p>Localized strings for all channels can be found in <a href="https://github.com/mozilla-l10n/firefox-l10n">firefox-l10n</a>, with a single subfolder for each locale.</p>
<p>The review process consists of three parts:</p>
<ul>
<li>Review strings landing in repository (using legacy <code>mozilla-central</code>).</li>
<li>Review strings extracted into the <code>update</code> branch of <code>firefox-l10n-source</code>. The <a href="https://github.com/mozilla-l10n/firefox-l10n-source/blob/main/.github/workflows/update.yml">automation</a> runs twice a day in the repository with any changes added to a pull request against the <code>main</code> repository.</li>
<li>Review and merge strings in the pull request to <code>main</code>, and start the localization process.</li>
</ul>
<p>Things to look out for during the review process:</p>
<ul>
<li>Unclear strings and missing localization comments: the best way to identify them is to translate the strings, only having the string and comment as context (not the entire file, or the bug). For example: is the word used as both a noun and a verb in English? Is the ID clear enough to give context (e.g. <code>buttonLabel</code>)?</li>
<li>String changes without new IDs.</li>
<li>Duplicated strings.</li>
<li><a href="https://mozilla-l10n.github.io/documentation/localization/dev_best_practices.html">Localization issues</a>, like misused plural forms, unclear comments, etc.</li>
</ul>
<h3 id="review-strings-landing-in-repository-using-legacy-mozilla-central"><a class="header" href="#review-strings-landing-in-repository-using-legacy-mozilla-central">Review strings landing in repository (using legacy mozilla-central)</a></h3>
<p>The most effective way to get the list of changes touching localized strings within the last 2 days is from the legacy mercurial repository <a href="https://hg.mozilla.org/mozilla-central/log?rev=keyword(%22locales/en-US%22)+and+pushdate(%22-2%22)">mozilla-central</a>. You can adjust the <code>pushdate</code> part if you want to see more or less days.</p>
<p>Note: this review includes changes landing in <code>mozilla-central</code>, but those changes may not have landed yet in <code>main</code> of <code>mozilla-firefox</code>, and consequently in <code>firefox-l10n-source</code>. Once changes have completed the landing process, those strings will also be available to review in the next step - <a href="#review-strings-in-update-branch-of-firefox-l10n-source">Review strings in update branch of firefox-l10n-source</a>.</p>
<p>There are some unrelated changesets, like en-US dictionary updates, but the majority of landings are relevant and need to be checked for localization issues. One exception to this are strings that are purposely not meant to be exposed to localizers, typically called "preview" strings. While these strings are often saved to files within the <code>browser/locales-preview</code> directory, this includes any localization file not saved in a <code>locales/en-US</code> path.</p>
<p>You need to open each changeset, and identify changed files that are relevant for localization (.properties, .dtd, .ini).</p>
<p>In case of issues, you have two options:</p>
<ul>
<li>Ask sheriffs (via bug or <a href="https://chat.mozilla.org/#/room/#sheriffs:mozilla.org">Matrix in #sheriffs</a>) to back out the patch.</li>
<li>Ask clarifications in the bug, and decide if it’s worth to stop exposing new strings until the issue is fixed.</li>
</ul>
<h3 id="review-strings-in-update-branch-of-firefox-l10n-source"><a class="header" href="#review-strings-in-update-branch-of-firefox-l10n-source">Review strings in update branch of firefox-l10n-source</a></h3>
<p>The next step is to check changes landing in the <code>update</code> branch of <a href="https://github.com/mozilla-l10n/firefox-l10n-source/tree/update">firefox-l10n-source</a>. Automation creates a <a href="https://github.com/mozilla-l10n/firefox-l10n-source/pulls">pull request</a> which includes any changed or added strings. Review the diff generated by the pull request.</p>
<p>Here are some things to look out for:</p>
<ul>
<li>Check if a changeset is removing strings. This should happen only when a string landed in Nightly and was removed during the same cycle, or at the beginning of a release cycle when a group of strings becomes unused in all shipping versions.</li>
</ul>
<p><strong>IMPORTANT:</strong> Patches including Fluent migrations need to be kept in the <code>update</code> branch, and can only be merged into <code>main</code> following the process described in <a href="../firefox_desktop/fluent_migrations.html">this document</a>.</p>
<h3 id="run-compare-locales-against-a-localization-repository"><a class="header" href="#run-compare-locales-against-a-localization-repository">Run compare-locales against a localization repository</a></h3>
<p>A good next step to check for issues is to run compare-locales against a localization repository frequently updated (Italian and French are good examples).</p>
<p>First of all make sure that you have both <a href="https://github.com/mozilla-l10n/firefox-l10n-source/">firefox-l10n-source</a> and <a href="https://github.com/mozilla-l10n/firefox-l10n">firefox-l10n</a> repositories cloned locally, and your local clones are updated.</p>
<p><code>compare-locales</code> needs to be installed on your system. You can either install a specific release, or install the latest release version via <code>pip install compare-locales</code>. You can check that <code>compare-locales</code> is running correctly by checking its version:</p>
<pre><code>$ compare-locales --version
compare-locales 9.0.4
</code></pre>
<p>Let’s assume that:</p>
<ul>
<li><code>firefox-l10n-source</code> is cloned in <code>~/firefox-l10n-source</code>.</li>
<li><code>firefox-l10n</code> is cloned in <code>~/firefox-l10n</code>.</li>
</ul>
<p>To run compare-locales against the string quarantine of <code>firefox-l10n-source</code> and Italian, first checkout the <code>update</code> branch of <code>firefox-l10n-source</code>, then run this command:</p>
<pre><code>$ compare-locales ~/firefox-l10n-source/_configs/browser.toml ~/firefox-l10n it
</code></pre>
<p>Because the command is quite long, it’s convenient to create a Bash aliases in <code>~/.bash_profile</code> for it, e.g.</p>
<pre><code>cmp_moz="compare-locales ~/firefox-l10n-source/_configs/browser.toml ~/firefox-l10n it"
</code></pre>
<p>Reviewing the output of <code>compare-locales</code> against the <code>update</code> branch of <code>firefox-l10n-source</code>: most of the time, it should only report missing strings. There will be obsolete strings only if a string was removed, which is a rare event.</p>
<p>For example, this is the output for a fully localized locale.</p>
<pre><code>$ compare-locales ~/firefox-l10n-source/_configs/browser.toml ~/firefox-l10n it
it:
changed       11768
changed_w     69481
unchanged       899
unchanged_w    1094
keys            426
92% of entries changed
</code></pre>
<p>Check the results for duplicated strings and errors. For example, if a new error shows up for a missing variable, it’s likely that a string changed without a new ID and introduced new variables.</p>
<p>You could also run <code>compare-locales</code> against the <code>main</code> branch of <code>mozilla-firefox</code>. However, the output is going to contain a lot of noise, since it includes all strings that are obsolete for <code>mozilla-firefox</code>, but are still needed for other branches. If you’re interested in only seeing missing strings, i.e. strings that need to be added to the l10n repository, you can <code>grep</code> the results by piping the output to <code>egrep '^\s*\+'</code>.</p>
<pre><code>$ compare-locales ~/firefox/browser/locales/l10n.toml ~/l10n it | egrep '^\s*\+'
</code></pre>
<h3 id="merge-reviewed-strings-to-main-branch-of-firefox-l10n-source"><a class="header" href="#merge-reviewed-strings-to-main-branch-of-firefox-l10n-source">Merge reviewed strings to main branch of firefox-l10n-source</a></h3>
<p>If there are no issues in the <code>update</code> branch of <code>firefox-l10n-source</code> and no pending <a href="../firefox_desktop/fluent_migrations.html">Fluent migrations</a>, the next step is to merge the <code>update</code> branch into the <code>main</code> repository by approving and merging the <a href="https://github.com/mozilla-l10n/firefox-l10n-source/pulls">pull request</a> in GitHub. Once merged this will expose content to Pontoon.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../products/firefox_desktop/removing_locales.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../products/firefox_desktop/fluent_migrations.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../products/firefox_desktop/removing_locales.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../products/firefox_desktop/fluent_migrations.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
